# ESPHome Device Configuration Framework

This repository contains a structured, reusable ESPHome configuration and build system for managing multiple embedded devices with consistent standards.

---

## ğŸ“ Project Layout

```text
.
â”œâ”€â”€ Makefile
â”œâ”€â”€ README.md
â”œâ”€â”€ VERSION
â”œâ”€â”€ Doxyfile
â”œâ”€â”€ configure.sh
â”œâ”€â”€ main.yaml
â”œâ”€â”€ common/
â”‚   â”œâ”€â”€ logging.yaml
â”‚   â”œâ”€â”€ ota.yaml
â”‚   â”œâ”€â”€ secrets.yaml       # Not tracked (gitignored)
â”‚   â”œâ”€â”€ web_server.yaml
â”‚   â””â”€â”€ wifi.yaml
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .makefile              # Autogenerated per-device
â””â”€â”€ <DEVICE_NAME>/
    â”œâ”€â”€ VERSION
    â”œâ”€â”€ common/
    â”‚   â””â”€â”€ ...            # Copied from root common/
    â””â”€â”€ <DEVICE_NAME>.yaml

```

---

## ğŸš€ Features

- YAML configuration templating via `envsubst`
- Automatic interactive `.makefile` generation
- Optional static IP configuration
- Per-device isolated build artifacts
- Logging, OTA, display, secrets, and Wi-Fi modularized under `common/`
- Doxygen documentation support

---

## ğŸ› ï¸ Getting Started

1. Clone the repo and run:

```bash
make
```

2. If `.makefile` does not exist, the script will prompt you to define:

- `DEVICE_NAME` (e.g. `sysmon-ph`)
- `NODE_NAME` (used for mDNS, should match or differ from device name)
- `FRIENDLY_NAME` (display name for Home Assistant)
- `COM_PORT` (e.g. `COM7`)
- Optional: Static IP, Gateway, Subnet, DNS

3. The following will be generated:

- `.makefile` with your selections
- `main.yaml` â†’ `<DEVICE_NAME>/<DEVICE_NAME>.yaml`
- Copied `common/` directory and `VERSION` file into your device folder

---

## ğŸ§¹ Maintenance Commands

```bash
make run       # Compile, upload, and stream logs
make build     # Just compile
make upload    # Upload + logs
make config    # Regenerate device config
make clean     # Remove generated device config
make clobber   # Remove config + .makefile and reset
make docs      # Generate documentation using Doxygen
```

---

## ğŸ§¾ Documentation

To generate project documentation:

```bash
make docs
```

Ensure you have a valid `Doxyfile` in the project root.

---

## âš ï¸ Secrets

- Secrets are stored in `common/secrets.yaml`
- This file is excluded from version control
- Use `!secret` in YAML to reference secure fields

---

## ğŸ™ Co-Authorship

This project was co-developed by:

- **Roland Tembo Hendel** (author, architect)
- **ChatGPT by OpenAI** (co-author, automation + documentation)

All code, automation, and documentation were designed through conversational collaboration.

---

## ğŸ“œ License

Licensed under the GNU General Public License v3.0  
SPDX-License-Identifier: GPL-3.0-or-later
